<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù¦Ù  Ø­Ø²Ø¨ Ù…Ù† Ø§Ù„Ù‚Ø±Ø¢Ù†</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ“–</text></svg>">
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        html, body { 
            overflow-x: hidden; 
            max-width: 100%; 
            height: 100%; 
            background: #f9f5eb; /* beige clair reposant */
            color: #1a1a1a; 
            font-family: 'Amiri', serif; 
        }
        body { padding: 20px; }
        #progress { margin-bottom: 25px; text-align: center; }
        #progress-circle { width: 120px; height: 120px; margin: 0 auto 10px; }
        select, input { 
            width: 100%; 
            padding: 14px; 
            font-size: 20px; 
            border: 1px solid #a1887f; 
            border-radius: 12px; 
            background: #fff; 
            margin-bottom: 15px; 
            box-shadow: 0 3px 6px rgba(0,0,0,0.08); 
        }
        #content { 
            direction: rtl; 
            white-space: pre-wrap; 
            line-height: 2; 
            background: #fffef7; 
            padding: 25px; 
            border-radius: 12px; 
            box-shadow: 0 6px 15px rgba(0,0,0,0.1); 
            transition: font-size 0.4s, opacity 0.5s; 
            opacity: 0; 
        }
        #content.loaded { opacity: 1; }
        .surah-title { 
            font-size: 28px; 
            color: #1e88e5; /* bleu luxueux */
            text-align: center; 
            margin: 30px 0 15px; 
            border-bottom: 2px solid #bbdefb; 
            padding-bottom: 10px; 
        }
        button { 
            padding: 14px 28px; 
            background: #1e88e5; 
            color: white; 
            border: none; 
            border-radius: 12px; 
            cursor: pointer; 
            font-size: 18px; 
            transition: all 0.3s; 
            box-shadow: 0 4px 8px rgba(0,0,0,0.1); 
            margin: 8px 4px; 
        }
        button:hover { background: #1565c0; transform: translateY(-3px); box-shadow: 0 8px 16px rgba(0,0,0,0.15); }
        button.undo { background: #ef5350; }
        button.undo:hover { background: #d32f2f; }
        button.reset { background: #42a5f5; }
        #font-size { display: flex; align-items: center; font-size: 18px; margin: 15px 0; }
        #font-slider { flex: 1; margin-left: 15px; }
        #favorites, #history { margin-top: 30px; }
        .favorite { 
            background: #e8f0fe; 
            padding: 12px; 
            border-radius: 10px; 
            margin-bottom: 12px; 
            cursor: pointer; 
            border-right: 4px solid #1e88e5; 
        }
        #loading { text-align: center; margin: 20px; font-size: 18px; color: #757575; font-style: italic; }
        h3 { color: #1e88e5; margin-bottom: 15px; text-align: center; }
    </style>
</head>
<body>
    <div id="progress">
        Ø§Ù„ØªÙ‚Ø¯Ù…: <span id="count">Ù /Ù¦Ù </span> (<span id="percent">Ù Ùª</span>)
        <svg id="progress-circle" viewBox="0 0 100 100">
            <circle cx="50" cy="50" r="45" fill="none" stroke="#e3f2fd" stroke-width="10"/>
            <circle cx="50" cy="50" r="45" fill="none" stroke="#1e88e5" stroke-width="10" stroke-dasharray="283" stroke-dashoffset="283" id="progress-ring"/>
        </svg>
    </div>

    <select id="hizbSelect" onchange="loadHizb(this.value)">
        <option value="">Ø§Ø®ØªØ± Ø­Ø²Ø¨Ù‹Ø§</option>
    </select>

    <select id="surahSelect" onchange="loadSurah(this.value)">
        <option value="">Ø§Ù„ØªÙ†Ù‚Ù„ Ø­Ø³Ø¨ Ø§Ù„Ø³ÙˆØ±Ø©</option>
    </select>

    <input type="text" id="search" placeholder="Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù†Øµ" oninput="searchText(this.value)">

    <div id="font-size">Ø­Ø¬Ù… Ø§Ù„Ù†Øµ: <input type="range" id="font-slider" min="16" max="32" value="22" oninput="adjustFont(this.value)"></div>

    <div id="loading" style="display:none;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>

    <div id="content"></div>

    <button class="reset" onclick="resetProgress()">Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªÙ‚Ø¯Ù…</button>

    <div id="favorites"><h3>Ø§Ù„Ù…ÙØ¶Ù„Ø©</h3></div>
    <div id="history"><h3>Ø§Ù„Ø³Ø¬Ù„</h3></div>

    <script>
        const hizbRanges = [ /* insÃ©rez ici le tableau complet hizbRanges comme avant */ ];
        const surahNames = [ /* insÃ©rez le tableau complet surahNames comme avant */ ];

        let readHizbs = JSON.parse(localStorage.getItem('hizbsRead')) || [];
        let favorites = JSON.parse(localStorage.getItem('favorites')) || [];
        let history = JSON.parse(localStorage.getItem('history')) || [];

        function updateProgress() {
            const count = readHizbs.length;
            const percent = (count / 60 * 100).toFixed(0);
            document.getElementById('count').textContent = `${count}/60`;
            document.getElementById('percent').textContent = `${percent}%`;
            document.getElementById('progress-ring').style.strokeDashoffset = 283 - (283 * percent / 100);
        }

        function renderSelects() {
            const hizbSelect = document.getElementById('hizbSelect');
            hizbSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø­Ø²Ø¨Ù‹Ø§</option>';
            for (let i = 1; i <= 60; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = `Ø§Ù„Ø­Ø²Ø¨ ${i}`;
                if (readHizbs.includes(i)) {
                    option.style.color = '#2e7d32'; // vert pour les terminÃ©s
                    option.textContent += ' (Ù…Ù†ØªÙ‡ÙŠ)';
                }
                hizbSelect.appendChild(option);
            }

            const surahSelect = document.getElementById('surahSelect');
            surahSelect.innerHTML = '<option value="">Ø§Ù„ØªÙ†Ù‚Ù„ Ø­Ø³Ø¨ Ø§Ù„Ø³ÙˆØ±Ø©</option>';
            surahNames.forEach((name, i) => {
                if (i > 0) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = name;
                    surahSelect.appendChild(option);
                }
            });
        }

        async function loadHizb(hizbNum) {
            if (!hizbNum) return;
            // Code fetch et affichage comme avant (simplifiÃ© ici pour focus sur fixes)
            // ... (gardez la logique de chargement du texte)
            // Ã€ la fin :
            const content = document.getElementById('content');
            content.classList.add('loaded');
            content.scrollIntoView({behavior: 'smooth'});
        }

        // Gardez les autres fonctions (markDone, unmarkDone, resetProgress, addFavorite, renderFavorites, etc.)
        // Adaptez les textes en arabe :
        // "TerminÃ©" â†’ "Ù…Ù†ØªÙ‡ÙŠ"
        // "Annuler" â†’ "Ø¥Ù„ØºØ§Ø¡"
        // "Ajouter aux Favoris" â†’ "Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙØ¶Ù„Ø©"
        // etc.

        // Appel initial
        renderSelects();
        updateProgress();
        // renderFavorites(); renderHistory(); etc.
    </script>
</body>
</html>
